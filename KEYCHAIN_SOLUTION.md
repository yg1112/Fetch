# ğŸ¯ Keychain å¼¹çª—é—®é¢˜ - å®Œæ•´è§£å†³æ–¹æ¡ˆ

## ğŸ“Š é—®é¢˜åˆ†æ

**ç°è±¡ï¼š** æ¯æ¬¡ Git push éƒ½å¼¹å‡ºä¸¤æ¬¡ Keychain å¯†ç è¯·æ±‚

**æ ¹æœ¬åŸå› ï¼š**
- ä½¿ç”¨ HTTPS æ–¹å¼è®¿é—® GitHubï¼ˆ`https://github.com/yg1112/Invoke.git`ï¼‰
- æ¯æ¬¡ push éƒ½éœ€è¦ä» keychain è¯»å– GitHub Personal Access Token
- macOS ä¸ºäº†å®‰å…¨ï¼Œæ¯æ¬¡è®¿é—®éƒ½è¦æ±‚ç¡®è®¤

---

## âœ… å·²å®æ–½çš„ä¼˜åŒ–æ–¹æ¡ˆ

### 1. **é…ç½® Git Credential Helper**
```bash
git config credential.helper osxkeychain
git config --global credential.helper "cache --timeout=3600"
```

**æ•ˆæœï¼š** å‡­æ®ä¼šç¼“å­˜ 1 å°æ—¶ï¼Œå‡å°‘ keychain è®¿é—®

### 2. **ä¼˜åŒ– Git ç¯å¢ƒå˜é‡**
åœ¨ `GitService.swift` ä¸­æ·»åŠ ï¼š
```swift
env["GIT_TERMINAL_PROMPT"] = "0"
env["GIT_ASKPASS"] = ""
```

**æ•ˆæœï¼š** é¿å…é¢å¤–çš„å¯†ç æç¤º

### 3. **æ·»åŠ é‡è¯•æœºåˆ¶**
å¦‚æœ push å¤±è´¥ï¼ˆç½‘ç»œ/æƒé™é—®é¢˜ï¼‰ï¼Œåªåšæœ¬åœ° commitï¼Œä¸é˜»å¡å·¥ä½œæµ

---

## ğŸ¯ æœ€ä½³å®è·µï¼šç‚¹å‡» "Always Allow"

ä¸‹æ¬¡å¼¹å‡º keychain æç¤ºæ—¶ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ git-credential-osxkeychain wants to     â”‚
â”‚ access key "github.com" in keychain.    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Password: â—â—â—â—â—â—â—â—â—â—â—â—                  â”‚
â”‚                                         â”‚
â”‚  [Always Allow]  [Deny]  [Allow]       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å…³é”®ï¼šç‚¹å‡» "Always Allow" è€Œä¸æ˜¯ "Allow"**

- âœ… **Always Allow**ï¼šæ°¸ä¹…æˆæƒï¼Œä¸å†å¼¹çª—
- âš ï¸ **Allow**ï¼šä¸´æ—¶æˆæƒï¼Œæ¯æ¬¡éƒ½å¼¹çª—

---

## ğŸš€ æ›´å½»åº•çš„è§£å†³æ–¹æ¡ˆï¼ˆå¯é€‰ï¼‰

### æ–¹æ¡ˆ Aï¼šä½¿ç”¨ SSH ä»£æ›¿ HTTPSï¼ˆæ¨èï¼‰

**ä¼˜ç‚¹ï¼š** å®Œå…¨ä¸éœ€è¦ keychainï¼Œä½¿ç”¨ SSH å¯†é’¥è®¤è¯

```bash
# 1. åˆ‡æ¢åˆ° SSH
git remote set-url origin git@github.com:yg1112/Invoke.git

# 2. éªŒè¯
git remote -v
# åº”è¯¥æ˜¾ç¤º: git@github.com:yg1112/Invoke.git

# 3. æµ‹è¯•
git push
```

**å‰æï¼š** éœ€è¦å…ˆåœ¨ GitHub æ·»åŠ  SSH å…¬é’¥

### æ–¹æ¡ˆ Bï¼šåªåšæœ¬åœ° Commitï¼Œä¸è‡ªåŠ¨ Push

ä¿®æ”¹ `GeminiLinkLogic.swift`ï¼Œè®©ç”¨æˆ·æ‰‹åŠ¨å†³å®šä½•æ—¶ pushï¼š

```swift
// é€‰é¡¹ï¼šç¦ç”¨è‡ªåŠ¨ push
func autoCommitOnly(message: String) {
    _ = try run(args: ["add", "."], in: projectRoot)
    _ = try run(args: ["commit", "-m", message], in: projectRoot)
    // ä¸è°ƒç”¨ push
}
```

---

## ğŸ§ª æµ‹è¯•æ–°ç‰ˆæœ¬

1. **å¯åŠ¨ Invoke**
```bash
open /Users/yukungao/github/Invoke/Invoke.app
```

2. **æµ‹è¯• Sync åŠŸèƒ½**
```bash
./quick_clipboard_test.sh
```

3. **å½“å¼¹å‡º Keychain æç¤ºæ—¶**
   - âœ… ç‚¹å‡» **"Always Allow"**
   - âœ… è¾“å…¥å¯†ç å¹¶ç¡®è®¤

4. **éªŒè¯**
   - ç¬¬ä¸€æ¬¡ï¼šå¯èƒ½å¼¹ 1-2 æ¬¡
   - ä¹‹åï¼šåº”è¯¥ä¸å†å¼¹çª—ï¼ˆ1 å°æ—¶å†…ï¼‰

---

## ğŸ“Š å¯¹æ¯”ï¼šBefore vs After

| åœºæ™¯ | Before | After |
|------|--------|-------|
| é¦–æ¬¡ Push | å¼¹çª— 2 æ¬¡ | å¼¹çª— 1-2 æ¬¡ï¼ˆç‚¹ Always Allowï¼‰ |
| åç»­ Pushï¼ˆ1 å°æ—¶å†…ï¼‰ | æ¯æ¬¡å¼¹çª— | **ä¸å¼¹çª—** âœ… |
| åç»­ Pushï¼ˆ1 å°æ—¶åï¼‰ | æ¯æ¬¡å¼¹çª— | å¼¹çª— 1 æ¬¡ï¼ˆé‡æ–°ç¼“å­˜ï¼‰ |

---

## ğŸ é¢å¤–ä¼˜åŒ–ï¼šå¯ç‚¹å‡»çš„ Commit é“¾æ¥

ç°åœ¨ commit hash æ˜¯**è“è‰²è¶…é“¾æ¥**ï¼Œç‚¹å‡»å³å¯åœ¨æµè§ˆå™¨æ‰“å¼€ GitHub diff é¡µé¢ï¼

**ç¤ºä¾‹ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ f63e6e1 â†—  Update: cleanup.sh     â”‚
â”‚  â†‘                                 â”‚
â”‚  ç‚¹å‡»æ‰“å¼€ GitHub commit é¡µé¢        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å®ç°åŸç†ï¼š**
1. è§£æ `git config remote.origin.url`
2. æ„å»º URLï¼š`https://github.com/user/repo/commit/<hash>`
3. ç”¨ `NSWorkspace.shared.open()` æ‰“å¼€æµè§ˆå™¨

---

## âœ… ç«‹å³æµ‹è¯•

```bash
# 1. å¯åŠ¨æ–°ç‰ˆæœ¬
open /Users/yukungao/github/Invoke/Invoke.app

# 2. æµ‹è¯• Sync
./quick_clipboard_test.sh

# 3. ç‚¹å‡» commit ç¼–å·ï¼ˆè“è‰²é“¾æ¥ï¼‰
#    åº”è¯¥è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨æ˜¾ç¤º GitHub diff

# 4. è§‚å¯Ÿ keychain å¼¹çª—
#    ç‚¹å‡» "Always Allow"
```

---

## ğŸ‰ é¢„æœŸæ•ˆæœ

- âœ… Keychain æç¤ºä»**æ¯æ¬¡ 2 æ¬¡**å‡å°‘åˆ°**é¦–æ¬¡ 1 æ¬¡**
- âœ… ç‚¹å‡» "Always Allow" åå®Œå…¨ä¸å†å¼¹çª—
- âœ… Commit hash å˜æˆå¯ç‚¹å‡»çš„è¶…é“¾æ¥
- âœ… ä¸€é”®æŸ¥çœ‹ GitHub diff

äº«å—æ›´æµç•…çš„ AI ååŒç¼–ç¨‹ä½“éªŒï¼ğŸš€
